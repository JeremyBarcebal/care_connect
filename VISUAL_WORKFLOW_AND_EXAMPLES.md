# Prescription System - Visual Workflow & Code Examples

## Visual User Journey

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    PRESCRIPTION FLOW                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

STEP 1: DOCTOR SENDS
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

Screen: Chat with Patient
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Dr. Smith (Doctor)    [ğŸ“]â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                      â”‚ â”‚  [ğŸ’Š] â† New button!
â”‚  â”‚  Hello John!         â”‚ â”‚
â”‚  â”‚  How are you today?  â”‚ â”‚
â”‚  â”‚                      â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ Type message...   [ğŸ“]â”‚ â”‚
â”‚  â”‚                 [ğŸ’Š][ğŸ“¤]â”‚ â† Medication button
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚
            â”‚ Click ğŸ’Š
            â–¼

STEP 2: SEND PRESCRIPTION DIALOG OPENS
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      Send Prescription               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                      â”‚
â”‚ Patient Information (Auto-filled)   â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚ â”‚ Name: John Doe                 â”‚  â”‚
â”‚ â”‚ ID: patient_uid_123            â”‚  â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                      â”‚
â”‚ Medicine Name *                      â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚ â”‚ Aspirin                        â”‚  â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                      â”‚
â”‚ Dosage *                             â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚ â”‚ 500mg                          â”‚  â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                      â”‚
â”‚ Frequency *                          â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚ â”‚ Twice daily                    â”‚  â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                      â”‚
â”‚ Preferred Time *                     â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚ â”‚ 09:00 AM                       â”‚  â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                      â”‚
â”‚ Instructions (Optional)              â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚ â”‚ Take with food                 â”‚  â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                      â”‚
â”‚    [Cancel]  [Send Prescription]    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


STEP 3: PRESCRIPTION APPEARS IN CHAT
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

Screen: Chat with Prescription
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Dr. Smith (Doctor)    [ğŸ“]â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  Hello John!         â”‚ â”‚
â”‚  â”‚  How are you today?  â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                            â”‚
â”‚               â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚               â”‚ ğŸ’Š Dr. Smith  â”‚ PENDING â”‚
â”‚               â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚               â”‚ Medicine: Aspirin        â”‚
â”‚               â”‚ Dosage: 500mg            â”‚
â”‚               â”‚ Frequency: Twice daily   â”‚
â”‚               â”‚ Time: 09:00 AM           â”‚
â”‚               â”‚ Instructions: Take with  â”‚
â”‚               â”‚                  food    â”‚
â”‚               â”‚                          â”‚
â”‚               â”‚ Patient Info:            â”‚
â”‚               â”‚   Name: John Doe         â”‚
â”‚               â”‚   ID: patient_uid_123    â”‚
â”‚               â”‚                          â”‚
â”‚               â”‚  [Decline]  [Accept]    â”‚
â”‚               â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ Type message...   [ğŸ“]â”‚ â”‚
â”‚  â”‚                 [ğŸ’Š][ğŸ“¤]â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


STEP 4A: PATIENT ACCEPTS
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

Patient clicks [Accept]
        â”‚
        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ âœ“ Prescription accepted! â”‚
â”‚   Added to your tasks.   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚
        â–¼
Firestore Updated:
accounts/patient_uid_123/task/11-11-2025
{
  tasks: [{
    title: "Aspirin",
    time: "09:00 AM",
    status: "pending"
  }]
}
        â”‚
        â–¼
Chat Message Updated:
chats/{chatId}/convo/{msgId}
status: "accepted" â† Changed from "pending"


STEP 4B: PATIENT DECLINES
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

Patient clicks [Decline]
        â”‚
        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Prescription declined.   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚
        â–¼
Chat Message Updated:
chats/{chatId}/convo/{msgId}
status: "declined"

(No task created)


STEP 5: PRESCRIPTION VISIBLE IN CLIENT PAGE
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

Screen: Patient Home (To be implemented)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     Patient Dashboard      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                            â”‚
â”‚  TODAY'S PRESCRIPTIONS     â”‚
â”‚                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ 09:00 AM             â”‚  â”‚
â”‚  â”‚ Aspirin - 500mg      â”‚  â”‚
â”‚  â”‚ Twice daily          â”‚  â”‚
â”‚  â”‚ Status: Pending      â”‚  â”‚
â”‚  â”‚  [Mark as Taken]     â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ 06:00 PM             â”‚  â”‚
â”‚  â”‚ Paracetamol - 1000mg â”‚  â”‚
â”‚  â”‚ Once at night        â”‚  â”‚
â”‚  â”‚ Status: Pending      â”‚  â”‚
â”‚  â”‚  [Mark as Taken]     â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Code Examples

### Example 1: Doctor Sends Prescription
```dart
// In ChatPage, when doctor clicks medication button:
void _showSendPrescriptionDialog() {
  showDialog(
    context: context,
    builder: (context) => SendPrescriptionDialog(
      patientId: widget.chatData['client'],           // Auto-filled
      patientName: widget.chatData['clientName'],     // Auto-filled
      onSend: (prescription) {
        _sendPrescriptionMessage(prescription);
      },
    ),
  );
}
```

### Example 2: Prescription Sent to Chat
```dart
// SendPrescriptionDialog creates this in Firestore:
await FirebaseFirestore.instance
    .collection('chats')
    .doc(widget.chatDocumentId)
    .collection('convo')
    .add({
  'type': 'prescription',              // Type identifier
  'medicineName': 'Aspirin',
  'dosage': '500mg',
  'frequency': 'Twice daily',
  'instructions': 'Take with food',
  'time': '09:00 AM',
  'status': 'pending',                 // Initial status
  'patientId': 'patient_uid_123',      // Auto-filled
  'patientName': 'John Doe',           // Auto-filled
  'sender': 'doctor_uid_456',
  'timestamp': FieldValue.serverTimestamp(),
});
```

### Example 3: Patient Accepts Prescription
```dart
// When patient clicks [Accept]:
Future<void> _acceptPrescription(
  Map<String, dynamic> prescription,
  String messageDocId,
) async {
  try {
    // Step 1: Add to patient's task collection
    await _taskService.addPrescriptionTask(
      prescription['patientId'],        // patient_uid_123
      prescription['medicineName'],     // Aspirin
      prescription['time'],             // 09:00 AM
    );

    // Step 2: Update chat message status
    await FirebaseFirestore.instance
        .collection('chats')
        .doc(widget.chatDocumentId)
        .collection('convo')
        .doc(messageDocId)
        .update({'status': 'accepted'});

    // Step 3: Show success
    ScaffoldMessenger.of(context).showSnackBar(
      const SnackBar(
        content: Text('Prescription accepted! Added to your tasks.'),
        backgroundColor: Colors.green,
      ),
    );
  } catch (e) {
    // Handle error
  }
}
```

### Example 4: Display in Firestore
```dart
// Result in Firestore after acceptance:

// In chat (persistent record):
chats/chat_123/convo/msg_456
{
  type: "prescription",
  medicineName: "Aspirin",
  status: "accepted"  â† Updated
  // ... other fields ...
}

// In patient's tasks (action item):
accounts/patient_uid_123/task/11-11-2025
{
  tasks: [
    {
      title: "Aspirin",
      time: "09:00 AM",
      status: "pending"
    }
  ]
}
```

### Example 5: Render Prescription Card
```dart
// The _buildPrescriptionMessage widget renders the card:
Widget _buildPrescriptionMessage(
  Map<String, dynamic> messageData,
  String sender,
  bool isCurrUser,
  bool showAcceptButton,
  String messageDocId,
) {
  final status = messageData['status'] ?? 'pending';
  
  return Container(
    decoration: BoxDecoration(
      color: Colors.green.shade50,
      borderRadius: BorderRadius.circular(10),
      border: Border.all(color: Colors.green, width: 1.5),
    ),
    child: Column(
      children: [
        // Header with doctor name and status badge
        Row(
          mainAxisAlignment: MainAxisAlignment.spaceBetween,
          children: [
            Text('ğŸ’Š ${sender}'),
            Container(
              decoration: BoxDecoration(
                color: status == 'accepted' ? Colors.green : Colors.orange,
              ),
              child: Text(status.toUpperCase()),
            ),
          ],
        ),
        
        // Prescription details
        _buildPrescriptionDetail('Medicine', messageData['medicineName']),
        _buildPrescriptionDetail('Dosage', messageData['dosage']),
        _buildPrescriptionDetail('Frequency', messageData['frequency']),
        _buildPrescriptionDetail('Time', messageData['time']),
        
        // Patient info
        Container(
          child: Column(
            children: [
              Text('Name: ${messageData['patientName']}'),
              Text('ID: ${messageData['patientId']}'),
            ],
          ),
        ),
        
        // Accept/Decline buttons (only for patient)
        if (showAcceptButton && status == 'pending')
          Row(
            children: [
              ElevatedButton(
                onPressed: () => _declinePrescription(messageDocId),
                child: Text('Decline'),
              ),
              ElevatedButton(
                onPressed: () => _acceptPrescription(messageData, messageDocId),
                child: Text('Accept'),
              ),
            ],
          ),
      ],
    ),
  );
}
```

## Firebase Collections Visualization

```
Firestore Database Structure
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

accounts/
â”œâ”€ doctor_uid_456/
â”‚  â””â”€ type: "doctor"
â”‚
â””â”€ patient_uid_123/
   â”œâ”€ type: "patient"
   â”œâ”€ name: "John Doe"
   â”œâ”€ email: "john@example.com"
   â””â”€ task/
      â”œâ”€ 11-10-2025/
      â”‚  â””â”€ tasks: [...]
      â””â”€ 11-11-2025/
         â””â”€ tasks: [
              {
                title: "Aspirin",
                time: "09:00 AM",
                status: "pending"
              },
              {
                title: "Paracetamol",
                time: "06:00 PM",
                status: "pending"
              }
            ]

chats/
â”œâ”€ chat_123/
â”‚  â”œâ”€ client: "patient_uid_123"
â”‚  â”œâ”€ doctor: "doctor_uid_456"
â”‚  â”œâ”€ doctorName: "Dr. Smith"
â”‚  â”œâ”€ clientName: "John Doe"
â”‚  â””â”€ convo/
â”‚     â”œâ”€ msg_001/
â”‚     â”‚  â”œâ”€ type: "text"
â”‚     â”‚  â”œâ”€ message: "Hello John!"
â”‚     â”‚  â”œâ”€ sender: "doctor_uid_456"
â”‚     â”‚  â””â”€ timestamp: 2025-11-11T10:00:00
â”‚     â”‚
â”‚     â””â”€ msg_002/
â”‚        â”œâ”€ type: "prescription"
â”‚        â”œâ”€ medicineName: "Aspirin"
â”‚        â”œâ”€ dosage: "500mg"
â”‚        â”œâ”€ frequency: "Twice daily"
â”‚        â”œâ”€ time: "09:00 AM"
â”‚        â”œâ”€ instructions: "Take with food"
â”‚        â”œâ”€ status: "accepted"
â”‚        â”œâ”€ patientId: "patient_uid_123"
â”‚        â”œâ”€ patientName: "John Doe"
â”‚        â”œâ”€ sender: "doctor_uid_456"
â”‚        â””â”€ timestamp: 2025-11-11T10:05:00
```

## Integration Points for Next Phase

### Phase 1: Display on Client Page
Location: `lib/pages/client_page.dart`

```dart
// Query pattern:
StreamBuilder<QuerySnapshot>(
  stream: FirebaseFirestore.instance
    .collection('accounts')
    .doc(userId)
    .collection('task')
    .snapshots(),
  builder: (context, snapshot) {
    // Parse tasks and display them
  },
)
```

### Phase 2: Add Notifications
Location: `lib/services/prescription_notification_service.dart`

```dart
// Watch for time and schedule notification
if (currentTime >= prescriptionTime) {
  flutterLocalNotificationsPlugin.show(
    id,
    'Time to take your medicine',
    'Take ${medicineName} now',
    notificationDetails,
  );
}
```

## Testing Commands

```bash
# Build and run
flutter pub get
flutter run

# Run analyze
flutter analyze

# Run with verbose
flutter run -v
```

## Troubleshooting

**Q: Prescription doesn't appear in chat?**
A: Check that `type: 'prescription'` is being saved to Firestore

**Q: Accept button not showing?**
A: Verify patient is viewing (isPatient && !isCurrUser) and status == 'pending'

**Q: Task not created after accept?**
A: Check TaskService.addPrescriptionTask() and Firestore permissions

**Q: Date format wrong in tasks?**
A: Verify DateFormat('MM-dd-yyyy') in TaskService
